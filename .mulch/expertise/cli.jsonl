{"type":"pattern","name":"CLI Command Structure","description":"All commands live in src/commands/{name}.ts. Each exports an async function matching the command name. CLI router in src/index.ts dispatches based on argv. Commands use Bun.spawn for subprocess calls. All state in .overstory/ directory.","classification":"foundational","recorded_at":"2026-02-12T15:18:26.091Z","tags":["commands","cli","structure"],"id":"mx-97add4"}
{"type":"pattern","name":"CLI command pattern with flag parsing","description":"All commands export an async function taking args: string[]. Use getFlag(args, '--name') for valued flags and hasFlag(args, '--json') for booleans. Use process.stdout.write (not console.log) for output. Wrap in try/finally to close DB stores. Use ValidationError for bad input, domain-specific errors (AgentError, MailError, MergeError) for operation failures.","classification":"tactical","recorded_at":"2026-02-12T15:40:08.301Z","tags":["cli","commands","patterns"],"id":"mx-4cd4ed"}
